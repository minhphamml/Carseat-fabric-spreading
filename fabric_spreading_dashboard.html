<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fabric Spreading Management Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-info {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            align-items: center;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .info-label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        .info-value {
            font-size: 1.1rem;
            color: #2c3e50;
            font-weight: 700;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
            transform: translateY(-2px);
        }

        .table-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        .data-table th,
        .data-table td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 0.9rem;
        }

        .data-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table tbody tr:nth-child(even) {
            background: rgba(102, 126, 234, 0.05);
        }

        .data-table tbody tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #666;
            margin-top: 8px;
            font-weight: 600;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .edit-btn, .delete-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .edit-btn {
            background: #28a745;
            color: white;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .edit-btn:hover, .delete-btn:hover {
            opacity: 0.8;
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .header-info {
                flex-direction: column;
                gap: 15px;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MANAGEMENT OF FABRIC SPREADING IN THE CARSEAT CUTTING STAGE IN 2025</h1>
            <div class="header-info">
                <div class="info-item">
                    <span class="info-label">Materials code</span>
                    <span class="info-value">ZL8</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Month</span>
                    <span class="info-value" id="currentMonth">7</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Total Records</span>
                    <span class="info-value" id="totalRecords">0</span>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('data-entry')">Data Entry</button>
            <button class="tab-btn" onclick="showTab('dashboard')">Dashboard</button>
        </div>

        <!-- Data Entry Tab -->
        <div id="data-entry" class="tab-content active">
            <div class="form-container">
                <h2 style="margin-bottom: 20px; color: #2c3e50;">Add New Record</h2>
                <form id="fabricForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="day">Day</label>
                            <input type="number" id="day" name="day" min="1" max="31" required>
                        </div>
                        <div class="form-group">
                            <label for="theoreticalSize">Theoretical Size (m/roll)</label>
                            <input type="number" id="theoreticalSize" name="theoreticalSize" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="stamp">S</label>
                            <input type="text" id="stamp" name="stamp" maxlength="10">
                        </div>
                        <div class="form-group">
                            <label for="meterNumber">Meter number on stamp (m/roll)</label>
                            <input type="number" id="meterNumber" name="meterNumber" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="lotNo">Lot no</label>
                            <input type="text" id="lotNo" name="lotNo" maxlength="20">
                        </div>
                        <div class="form-group">
                            <label for="drawingName">Drawing Name</label>
                            <input type="text" id="drawingName" name="drawingName" maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="unfinishedRoll">Unfinished Roll (mm)</label>
                            <input type="number" id="unfinishedRoll" name="unfinishedRoll" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="spreadSize">Spread Size (mm)</label>
                            <input type="number" id="spreadSize" name="spreadSize" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="numberOfPlates">Number of Plates (pcs)</label>
                            <input type="number" id="numberOfPlates" name="numberOfPlates" min="0">
                        </div>
                        <div class="form-group">
                            <label for="supplierDisposable">Supplier Disposable Connector Plate (mm)</label>
                            <input type="number" id="supplierDisposable" name="supplierDisposable" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="usedConnectorPlate">Used Connector Plate (mm)</label>
                            <input type="number" id="usedConnectorPlate" name="usedConnectorPlate" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="platesUsed">Number of Plates Used (pcs)</label>
                            <input type="number" id="platesUsed" name="platesUsed" min="0">
                        </div>
                        <div class="form-group">
                            <label for="discardedRoll">Discarded Roll End Material (mm)</label>
                            <input type="number" id="discardedRoll" name="discardedRoll" step="0.1">
                        </div>
                        <div class="form-group">
                            <label for="unfinishedRollEnd">Unfinished Roll (mm/roll)</label>
                            <input type="number" id="unfinishedRollEnd" name="unfinishedRollEnd" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="quantityDeviation">Quantity Deviation On Roll (mm/roll)</label>
                            <input type="number" id="quantityDeviation" name="quantityDeviation" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="personInCharge">Person in Charge</label>
                            <input type="text" id="personInCharge" name="personInCharge" maxlength="50">
                        </div>
                        <div class="form-group">
                            <label for="confirmSub">Confirm sub Leader</label>
                            <input type="text" id="confirmSub" name="confirmSub" maxlength="50">
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary" onclick="resetForm()">Reset</button>
                        <button type="submit" class="btn btn-primary">Add Record</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalRolls">0</div>
                    <div class="stat-label">Total Rolls Processed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgTheoretical">0</div>
                    <div class="stat-label">Average Theoretical Size (m)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalPlates">0</div>
                    <div class="stat-label">Total Plates Used</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalWaste">0</div>
                    <div class="stat-label">Total Waste Material (mm)</div>
                </div>
            </div>

            <div class="table-container">
                <h2 style="margin-bottom: 20px; color: #2c3e50;">Fabric Spreading Records</h2>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Day</th>
                            <th>Theoretical Size</th>
                            <th>S</th>
                            <th>Meter number on stamp</th>
                            <th>Lot no</th>
                            <th>Drawing Name</th>
                            <th>Unfinished Roll</th>
                            <th>Spread Size</th>
                            <th>Number of Plates</th>
                            <th>Supplier Disposable</th>
                            <th>Used Connector Plate</th>
                            <th>Plates Used</th>
                            <th>Discarded Roll</th>
                            <th>Unfinished Roll</th>
                            <th>Quantity Deviation</th>
                            <th>Person in Charge</th>
                            <th>Confirm sub Leader</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeEditModal()">&times;</span>
            <h2 style="margin-bottom: 20px; color: #2c3e50;">Edit Record</h2>
            <form id="editForm">
                <input type="hidden" id="editIndex" name="editIndex">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editDay">Day</label>
                        <input type="number" id="editDay" name="day" min="1" max="31" required>
                    </div>
                    <div class="form-group">
                        <label for="editTheoreticalSize">Theoretical Size (m/roll)</label>
                        <input type="number" id="editTheoreticalSize" name="theoreticalSize" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editStamp">S</label>
                        <input type="text" id="editStamp" name="stamp" maxlength="10">
                    </div>
                    <div class="form-group">
                        <label for="editMeterNumber">Meter number on stamp (m/roll)</label>
                        <input type="number" id="editMeterNumber" name="meterNumber" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="editLotNo">Lot no</label>
                        <input type="text" id="editLotNo" name="lotNo" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="editDrawingName">Drawing Name</label>
                        <input type="text" id="editDrawingName" name="drawingName" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label for="editUnfinishedRoll">Unfinished Roll (mm)</label>
                        <input type="number" id="editUnfinishedRoll" name="unfinishedRoll" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editSpreadSize">Spread Size (mm)</label>
                        <input type="number" id="editSpreadSize" name="spreadSize" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editNumberOfPlates">Number of Plates (pcs)</label>
                        <input type="number" id="editNumberOfPlates" name="numberOfPlates" min="0">
                    </div>
                    <div class="form-group">
                        <label for="editSupplierDisposable">Supplier Disposable Connector Plate (mm)</label>
                        <input type="number" id="editSupplierDisposable" name="supplierDisposable" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editUsedConnectorPlate">Used Connector Plate (mm)</label>
                        <input type="number" id="editUsedConnectorPlate" name="usedConnectorPlate" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editPlatesUsed">Number of Plates Used (pcs)</label>
                        <input type="number" id="editPlatesUsed" name="platesUsed" min="0">
                    </div>
                    <div class="form-group">
                        <label for="editDiscardedRoll">Discarded Roll End Material (mm)</label>
                        <input type="number" id="editDiscardedRoll" name="discardedRoll" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="editUnfinishedRollEnd">Unfinished Roll (mm/roll)</label>
                        <input type="number" id="editUnfinishedRollEnd" name="unfinishedRollEnd" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="editQuantityDeviation">Quantity Deviation On Roll (mm/roll)</label>
                        <input type="number" id="editQuantityDeviation" name="quantityDeviation" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="editPersonInCharge">Person in Charge</label>
                        <input type="text" id="editPersonInCharge" name="personInCharge" maxlength="50">
                    </div>
                    <div class="form-group">
                        <label for="editConfirmSub">Confirm sub Leader</label>
                        <input type="text" id="editConfirmSub" name="confirmSub" maxlength="50">
                    </div>
                </div>
                <div class="btn-group" style="margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Record</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let fabricData = [];
        let editingIndex = -1;

        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remove active class from all buttons
            const tabBtns = document.querySelectorAll('.tab-btn');
            tabBtns.forEach(btn => btn.classList.remove('active'));

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Update dashboard when switching to it
            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }

        // Form submission
        document.getElementById('fabricForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const recordData = {};
            
            // Convert form data to object
            formData.forEach((value, key) => {
                recordData[key] = value;
            });

            // Add to data array
            fabricData.push(recordData);

            // Reset form
            this.reset();

            // Update counters
            updateCounters();

            // Show success message
            alert('Record added successfully!');
        });

        // Edit form submission
        document.getElementById('editForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const recordData = {};
            
            // Convert form data to object
            formData.forEach((value, key) => {
                if (key !== 'editIndex') {
                    recordData[key] = value;
                }
            });

            const index = parseInt(document.getElementById('editIndex').value);
            fabricData[index] = recordData;

            closeEditModal();
            updateDashboard();
            alert('Record updated successfully!');
        });

        // Reset form
        function resetForm() {
            document.getElementById('fabricForm').reset();
        }

        // Update counters
        function updateCounters() {
            document.getElementById('totalRecords').textContent = fabricData.length;
        }

        // Update dashboard
        function updateDashboard() {
            updateStatistics();
            updateTable();
        }

        // Update statistics
        function updateStatistics() {
            if (fabricData.length === 0) {
                document.getElementById('totalRolls').textContent = '0';
                document.getElementById('avgTheoretical').textContent = '0';
                document.getElementById('totalPlates').textContent = '0';
                document.getElementById('totalWaste').textContent = '0';
                return;
            }

            // Total rolls
            document.getElementById('totalRolls').textContent = fabricData.length;

            // Average theoretical size
            const avgTheoretical = fabricData.reduce((sum, record) => {
                return sum + (parseFloat(record.theoreticalSize) || 0);
            }, 0) / fabricData.length;
            document.getElementById('avgTheoretical').textContent = avgTheoretical.toFixed(1);

            // Total plates used
            const totalPlates = fabricData.reduce((sum, record) => {
                return sum + (parseInt(record.platesUsed) || 0);
            }, 0);
            document.getElementById('totalPlates').textContent = totalPlates;

            // Total waste material
            const totalWaste = fabricData.reduce((sum, record) => {
                return sum + (parseFloat(record.discardedRoll) || 0);
            }, 0);
            document.getElementById('totalWaste').textContent = totalWaste.toFixed(1);
        }

        // Update table
        function updateTable() {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';

            fabricData.forEach((record, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${record.day || ''}</td>
                    <td>${record.theoreticalSize || ''}</td>
                    <td>${record.stamp || ''}</td>
                    <td>${record.meterNumber || ''}</td>
                    <td>${record.lotNo || ''}</td>
                    <td>${record.drawingName || ''}</td>
                    <td>${record.unfinishedRoll || ''}</td>
                    <td>${record.spreadSize || ''}</td>
                    <td>${record.numberOfPlates || ''}</td>
                    <td>${record.supplierDisposable || ''}</td>
                    <td>${record.usedConnectorPlate || ''}</td>
                    <td>${record.platesUsed || ''}</td>
                    <td>${record.discardedRoll || ''}</td>
                    <td>${record.unfinishedRollEnd || ''}</td>
                    <td>${record.quantityDeviation || ''}</td>
                    <td>${record.personInCharge || ''}</td>
                    <td>${record.confirmSub || ''}</td>
                    <td>
                        <button class="edit-btn" onclick="editRecord(${index})">Edit</button>
                        <button class="delete-btn" onclick="deleteRecord(${index})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Edit record
        function editRecord(index) {
            const record = fabricData[index];
            document.getElementById('editIndex').value = index;
            
            // Populate edit form
            document.getElementById('editDay').value = record.day || '';
            document.getElementById('editTheoreticalSize').value = record.theoreticalSize || '';
            document.getElementById('editStamp').value = record.stamp || '';
            document.getElementById('editMeterNumber').value = record.meterNumber || '';
            document.getElementById('editLotNo').value = record.lotNo || '';
            document.getElementById('editDrawingName').value = record.drawingName || '';
            document.getElementById('editUnfinishedRoll').value = record.unfinishedRoll || '';
            document.getElementById('editSpreadSize').value = record.spreadSize || '';
            document.getElementById('editNumberOfPlates').value = record.numberOfPlates || '';
            document.getElementById('editSupplierDisposable').value = record.supplierDisposable || '';
            document.getElementById('editUsedConnectorPlate').value = record.usedConnectorPlate || '';
            document.getElementById('editPlatesUsed').value = record.platesUsed || '';
            document.getElementById('editDiscardedRoll').value = record.discardedRoll || '';
            document.getElementById('editUnfinishedRollEnd').value = record.unfinishedRollEnd || '';
            document.getElementById('editQuantityDeviation').value = record.quantityDeviation || '';
            document.getElementById('editPersonInCharge').value = record.personInCharge || '';
            document.getElementById('editConfirmSub').value = record.confirmSub || '';
            
            // Show modal
            document.getElementById('editModal').style.display = 'block';
        }

        // Close edit modal
        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        // Delete record
        function deleteRecord(index) {
            if (confirm('Are you sure you want to delete this record?')) {
                fabricData.splice(index, 1);
                updateCounters();
                updateDashboard();
                alert('Record deleted successfully!');
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('editModal');
            if (event.target === modal) {
                closeEditModal();
            }
        }

        // Add some sample data for demonstration
        function addSampleData() {
            const sampleRecords = [
                {
                    day: '1',
                    theoreticalSize: '50.5',
                    stamp: 'A001',
                    meterNumber: '50.2',
                    lotNo: 'ZL8-001',
                    drawingName: 'CS-FRONT-001',
                    unfinishedRoll: '45.2',
                    spreadSize: '1800',
                    numberOfPlates: '8',
                    supplierDisposable: '2.5',
                    usedConnectorPlate: '2.3',
                    platesUsed: '7',
                    discardedRoll: '3.2',
                    unfinishedRollEnd: '2.1',
                    quantityDeviation: '0.3',
                    personInCharge: 'John Doe',
                    confirmSub: 'Jane Smith'
                },
                {
                    day: '2',
                    theoreticalSize: '48.7',
                    stamp: 'A002',
                    meterNumber: '48.5',
                    lotNo: 'ZL8-002',
                    drawingName: 'CS-BACK-001',
                    unfinishedRoll: '44.1',
                    spreadSize: '1750',
                    numberOfPlates: '6',
                    supplierDisposable: '2.4',
                    usedConnectorPlate: '2.2',
                    platesUsed: '6',
                    discardedRoll: '2.8',
                    unfinishedRollEnd: '1.8',
                    quantityDeviation: '0.2',
                    personInCharge: 'Mike Johnson',
                    confirmSub: 'Sarah Wilson'
                },
                {
                    day: '3',
                    theoreticalSize: '52.1',
                    stamp: 'A003',
                    meterNumber: '51.8',
                    lotNo: 'ZL8-003',
                    drawingName: 'CS-SIDE-001',
                    unfinishedRoll: '46.5',
                    spreadSize: '1850',
                    numberOfPlates: '9',
                    supplierDisposable: '2.6',
                    usedConnectorPlate: '2.4',
                    platesUsed: '8',
                    discardedRoll: '3.5',
                    unfinishedRollEnd: '2.3',
                    quantityDeviation: '0.3',
                    personInCharge: 'Alex Brown',
                    confirmSub: 'Lisa Davis'
                }
            ];

            // Add sample data to the array
            fabricData.push(...sampleRecords);
            updateCounters();
            updateDashboard();
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            updateCounters();
            
            // Add sample data button for demonstration
            const header = document.querySelector('.header');
            const sampleBtn = document.createElement('button');
            sampleBtn.textContent = 'Load Sample Data';
            sampleBtn.className = 'btn btn-secondary';
            sampleBtn.style.marginTop = '10px';
            sampleBtn.onclick = addSampleData;
            header.appendChild(sampleBtn);
        });

        // Export functionality
        function exportToCSV() {
            if (fabricData.length === 0) {
                alert('No data to export!');
                return;
            }

            const headers = [
                'Day', 'Theoretical Size', 'S', 'Meter Number', 'Lot No', 'Drawing Name',
                'Unfinished Roll', 'Spread Size', 'Number of Plates', 'Supplier Disposable',
                'Used Connector Plate', 'Plates Used', 'Discarded Roll', 'Unfinished Roll End',
                'Quantity Deviation', 'Person in Charge', 'Confirm Sub Leader'
            ];

            const csvContent = [
                headers.join(','),
                ...fabricData.map(record => [
                    record.day || '',
                    record.theoreticalSize || '',
                    record.stamp || '',
                    record.meterNumber || '',
                    record.lotNo || '',
                    record.drawingName || '',
                    record.unfinishedRoll || '',
                    record.spreadSize || '',
                    record.numberOfPlates || '',
                    record.supplierDisposable || '',
                    record.usedConnectorPlate || '',
                    record.platesUsed || '',
                    record.discardedRoll || '',
                    record.unfinishedRollEnd || '',
                    record.quantityDeviation || '',
                    record.personInCharge || '',
                    record.confirmSub || ''
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'fabric_spreading_data.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Add export button to dashboard
        function addExportButton() {
            const dashboardTab = document.getElementById('dashboard');
            const exportBtn = document.createElement('button');
            exportBtn.textContent = 'Export to CSV';
            exportBtn.className = 'btn btn-primary';
            exportBtn.style.marginBottom = '20px';
            exportBtn.onclick = exportToCSV;
            
            const tableContainer = document.querySelector('.table-container');
            dashboardTab.insertBefore(exportBtn, tableContainer);
        }

        // Add export button when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            addExportButton();
        });

        // Search functionality
        function searchRecords() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const filteredData = fabricData.filter(record => {
                return Object.values(record).some(value => 
                    value.toString().toLowerCase().includes(searchTerm)
                );
            });
            
            updateTableWithData(filteredData);
        }

        // Update table with specific data
        function updateTableWithData(data) {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';

            data.forEach((record, index) => {
                const originalIndex = fabricData.indexOf(record);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${originalIndex + 1}</td>
                    <td>${record.day || ''}</td>
                    <td>${record.theoreticalSize || ''}</td>
                    <td>${record.stamp || ''}</td>
                    <td>${record.meterNumber || ''}</td>
                    <td>${record.lotNo || ''}</td>
                    <td>${record.drawingName || ''}</td>
                    <td>${record.unfinishedRoll || ''}</td>
                    <td>${record.spreadSize || ''}</td>
                    <td>${record.numberOfPlates || ''}</td>
                    <td>${record.supplierDisposable || ''}</td>
                    <td>${record.usedConnectorPlate || ''}</td>
                    <td>${record.platesUsed || ''}</td>
                    <td>${record.discardedRoll || ''}</td>
                    <td>${record.unfinishedRollEnd || ''}</td>
                    <td>${record.quantityDeviation || ''}</td>
                    <td>${record.personInCharge || ''}</td>
                    <td>${record.confirmSub || ''}</td>
                    <td>
                        <button class="edit-btn" onclick="editRecord(${originalIndex})">Edit</button>
                        <button class="delete-btn" onclick="deleteRecord(${originalIndex})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Add search functionality to dashboard
        function addSearchBox() {
            const dashboardTab = document.getElementById('dashboard');
            const searchContainer = document.createElement('div');
            searchContainer.style.marginBottom = '20px';
            searchContainer.innerHTML = `
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="searchInput" placeholder="Search records..." 
                           style="flex: 1; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1rem;">
                    <button onclick="searchRecords()" class="btn btn-secondary">Search</button>
                    <button onclick="clearSearch()" class="btn btn-secondary">Clear</button>
                </div>
            `;
            
            const tableContainer = document.querySelector('.table-container');
            dashboardTab.insertBefore(searchContainer, tableContainer);
        }

        // Clear search
        function clearSearch() {
            document.getElementById('searchInput').value = '';
            updateTable();
        }

        // Add search box when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            addSearchBox();
        });
    </script>
</body>
</html>
            